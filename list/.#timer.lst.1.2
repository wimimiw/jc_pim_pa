C51 COMPILER V7.06   TIMER                                                                 04/24/2006 10:56:53 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\OUTPUT\timer.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE APP\timer.c BROWSE INCDIR(.\APP;.\drive;.\LPC900) DEBUG OBJECTEXTEND PRINT(
                    -.\list\timer.lst) OBJECT(.\OUTPUT\timer.obj)

stmt level    source

   1          /**-------------文件信息--------------------------------------------------------------------------------
   2          **文   件   名: timer.c
   3          **创   建   人: 程莺红
   4          **修   改   人: 
   5          **最后修改日期: 2006年3月31日
   6          **最 新 版  本: V1.2
   7          **描        述: 完成定时器的初始化，中断响应以及系统时钟计时
   8          **
   9          **--------------历史版本信息----------------------------------------------------------------------------
  10          ** 创建人: 程莺红 
  11          ** 版  本: V1.2
  12          ** 日　期: 2006年3月31日
  13          ** 描　述: 原始版本
  14          **
  15          ********************************************************************************************************/
  16          
  17          #include <reg938.h>
  18          #include <timer.h>
  19                                                                  
  20          static unsigned long sysTime = 0L;
  21          static unsigned char softTimerCnt = 0;
  22          
  23          /*
  24          *********************************************************************************************************
  25          *                         初始化定时器
  26          *
  27          * Description: 初始化定时工作模式以及初始值
  28          *
  29          * Arguments  : 无
  30          * Returns    : 无
  31          *********************************************************************************************************
  32          */
  33          void InitTimer1()
  34          {
  35   1              TMOD = 0x10;
  36   1      
  37   1          TH1 = 0x28;    
  38   1          TL1 = 0x00;
  39   1              
  40   1              ET1 = 1;
  41   1          TR1 = 1;
  42   1      
  43   1      }
  44          
  45          /*
  46          *********************************************************************************************************
  47          *                         定时器值重装
  48          *
  49          * Description: 定时中断，定时器溢出重装
  50          *
  51          * Arguments  : 无
  52          * Returns    : 无
  53          *********************************************************************************************************
  54          */
C51 COMPILER V7.06   TIMER                                                                 04/24/2006 10:56:53 PAGE 2   

  55          void Timer1( void ) interrupt 3 
  56          {
  57   1              TR1 = 0;
  58   1          TH1 = 0x28;                 //定时器初始值，定时器溢出时间为10ms
  59   1          TL1 = 0x00;
  60   1              EA=0 ;
  61   1              sysTime++;
  62   1              EA=1 ;
  63   1              TR1 = 1;
  64   1      
  65   1      }
  66          /*
  67          *********************************************************************************************************
  68          *                         获取系统时间
  69          *
  70          * Description: 取得系统时间
  71          *
  72          * Arguments  : 无
  73          * Returns    : ticks
  74          *********************************************************************************************************
  75          */
  76          unsigned long getTime() small
  77          {
  78   1              unsigned long  ticks;   
  79   1      
  80   1              EA = 0;;
  81   1              ticks = sysTime;
  82   1              EA = 1;
  83   1                                              
  84   1              return (ticks);
  85   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     71    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
